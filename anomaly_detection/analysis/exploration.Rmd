---
title: "exploration"
author: "Ted Ladas - s2124289"
date: "01/06/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(keras)
library(tidymodels)
library(data.table)
library(ggplot2)
library(readr)
library(skimr)
library(GGally)
# library("ggpubr")
# library(ggcorrplot)
# library(gridExtra)
# library(ggridges)

libs <- c("keras",
          "tidymodels",
          "data.table",
          "ggplot2",
          "readr",
          "glimpse",
          "skimr",
          "GGally")

cat(paste0(libs, ' library version: ', packageVersion(libs), '\n'))
```

Load the dataset and explore the variables

```{r}
wine <- as.data.table(read_csv(".././data/wine.csv"))
wine %>% 
  count(quality)
wine %>% 
  count(type)

skim(wine)
```

All variables are considered double, yet some are factors (quality, type)
We can perform an initial EDA to find more research questions
Potentially interesting models from this stage:
- can we predict type / quality from this dataset?

```{r}
wine <- as.data.table(read_csv(".././data/wine.csv"))

wine <- wine %>%
  mutate(
    free.sulfur.dioxide = as.integer(free.sulfur.dioxide),
    total.sulfur.dioxide = as.integer(total.sulfur.dioxide),
    w.type = factor(type),
    quality_bucket = case_when(
      quality >= 8 ~ "high",
      quality <= 4 ~ "low",
      TRUE ~ "medium"
    ),
    quality = factor(quality),
  )
# # Note the best plot
# wine %>%
#   select(fixed.acidity,
#          residual.sugar,
#          chlorides,
#          pH,
#          quality,
#          type) %>%
#   ggpairs(mapping = aes(color=type))

wine %>% ggplot(aes(x = quality, y = , color = w.type)) +
  geom_point(alpha = 0.7)
```

